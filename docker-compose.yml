version: '3.9'

services:
  # Servidores Web Sub-rede A
  webserver_a:
    build:
      context: ./webserver_A
    networks:
      subnet_a:
        ipv4_address: 10.0.0.10
    ports:
      - "8080:80"

  # Servidores Web Sub-rede B
  webserver_b:
    build:
      context: ./webserver_B
    networks:
      subnet_b:
        ipv4_address: 20.0.0.10
    ports:
      - "8081:80"

  # Servidor DNS Sub-rede A
  dns_a:
    build:
      context: ./dns_A
    networks:
      subnet_a:
        ipv4_address: 10.0.0.11
    ports:
      - "5355:53/udp"  # Porta para DNS
    cap_add:
      - NET_ADMIN

  # Servidor DNS Sub-rede B
  dns_b:
    build:
      context: ./dns_B
    networks:
      subnet_b:
        ipv4_address: 20.0.0.11
    ports:
      - "5356:53/udp"
    cap_add:
      - NET_ADMIN

  # Firewall e DHCP
  firewall:
    build:
      context: ./firewall
    networks:
      subnet_a:
      subnet_b:
    cap_add:
      - NET_ADMIN
    ports:
      - "67:67/udp"  # Porta DHCP
      - "68:68/udp"

networks:
  subnet_a:
    driver: bridge
    ipam:
      config:
        - subnet: 10.0.0.0/24
  subnet_b:
    driver: bridge
    ipam:
      config:
        - subnet: 20.0.0.0/24
